<tool id="gem_check_memote" name="GEM check memote" version="0.17.0">
  <macros>
    <import>gem_macros.xml</import>
  </macros>
  <description>Uses the Memote test suite to generate a quality report on a genome-scale metabolic model. See more at https://memote.readthedocs.io/en/latest/index.html</description>
  <requirements>
    <requirement type="package" version="0.17.0">memote</requirement>
    <requirement type="package" version="8.3.3">pytest</requirement>
    <requirement type="package" version="2.0.1">markupsafe</requirement>
  </requirements>
  <expand macro="version_command_memote"/>
  <command>
    python '$__tool_directory__/gem_check_memote.py' '--cb_model_location' '${cb_model_location}' '--output' '${output}'
  </command>
  <inputs>
    <expand macro="input_model"/>
  </inputs>
  <outputs>
    <data name="output" format="html" label="Memote report"/>
  </outputs>
  <tests>
    <!-- Test 1: Valid E. coli core model -->
    <test>
      <param name="cb_model_location" value="textbook_model_cobrapy.xml"/>
      <output name="output">
        <assert_contents>
          <has_text text="Stoichiometric Consistency"/>
        </assert_contents>
      </output>
    </test>
    <!-- Test 2: Invalid model format -->
    <test expect_failure="true">
      <param name="cb_model_location" value="invalid_format.txt"/>
      <assert_stderr>
        <has_text text="Most likely the SBML model is not valid"/>
      </assert_stderr>
    </test>
  </tests>
  <help><![CDATA[
    Memote Model Quality Check

    The GEM Check Memote tool runs the Memote test suite to generate a detailed report on the quality of a genome-scale metabolic model (GEM). Memote assesses various model characteristics such as stoichiometric consistency and model annotations.

    Inputs
    ------

    `Model to check with memote`: The metabolic model in SBML format (.xml or .sbml) to be analyzed by Memote. Ensure the file conforms to SBML standards.

    Outputs
    -------

    `Memote report`: An HTML file that contains the full results of the Memote assessment. This report includes overall model quality scores and highlights any issues that need correction.

    Usage Example
    -------------

    1. Upload your SBML model file.
    2. Run the tool to generate the Memote report.
    3. Review the report to identify any errors or areas for improvement in the model.

    Troubleshooting
    ---------------
    
    If the tool fails to run, ensure that your input file is a valid SBML model. Incorrect file formats or non-compliant models may trigger errors.

    References
    ----------
    
    Full documentation and further examples can be found at: https://memote.readthedocs.io/en/latest/index.html
  ]]></help>
  <citations>
    <citation type="bibtex">
      @article{lieven2020memote,
        title={MEMOTE for standardized genome-scale metabolic model testing},
        author={Lieven, Christian and Beber, Moritz E and Olivier, Brett G and Bergmann, Frank T and Ataman, Meric and Babaei, Parizad and Bartell, Jennifer A and Blank, Lars M and Chauhan, Siddharth and Correia, Kevin and others},
        journal={Nature biotechnology},
        volume={38},
        number={3},
        pages={272--276},
        year={2020},
        publisher={Nature Publishing Group US New York}
      }
    </citation>
  </citations>
</tool>